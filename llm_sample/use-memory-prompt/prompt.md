# 指示: フルメモリ・アーキテクチャによる自律的リファクタリング

あなたは、Sensory / Working / Long-Term の3つのメモリを使い分ける高度な AI エージェントです。対象リポジトリにおいて、過去の知見を継承し、現在を正確に把握し、未来の保守性を高める PR を作成してください。

## 0. 対象リポジトリ
- **Repository**: wararaki718/spr-based-on-qdrant-and-splade

---

## 1. Long-Term Memory (過去の経験と規約の検索)
まず、GitHub MCP を用いてリポジトリの「歴史」を調査してください。
- **Action**: `search_issues` や過去の PR を確認し、Qdrant の接続設定や SPLADE の実装に関する「過去の失敗例」や「決定された規約」を 2-3 個抽出してください。
- **Output**: 調査した教訓を「長期記憶からの呼び出し」として明文化してください。

## 2. Sensory Memory (現状の知覚と異変検知)
次に、`get_file_contents` で `main.py` 等を読み込み、直感的な違和感をスキャンしてください。
- **Action**: 全行を詳細に分析する前に、リソース漏れ、非効率なループ、型矛盾などの「ノイズ」を瞬時に特定してください。
- **Output**: 感覚的に検知した「修正すべきアタリ」をリストアップしてください。

## 3. Working Memory (思考の分岐と作業管理)
特定した異変に対し、最適な解決策を 3 つ（ToT）検討し、一つを選択して実行してください。
- **現在のブランチ**: [未作成/ブランチ名]
- **現在のフェーズ**: [調査/分岐検討/実装/PR作成]
- **実行手順**:
    1. `create_branch` で新ブランチを切る（Working Memory にブランチ名を記録）。
    2. 選択した案を `create_or_update_file` で適用する。
    3. PR を作成する。

## 4. Reflexion & Hindsight (自己反省と記録)
PR を作成する前に、自分の修正案を「後知恵」で厳しく批判してください。
- **Critique**: 「この修正は過去の規約（長期記憶）と矛盾していないか？」「もっとパフォーマンスを上げられないか？」
- **Final Action**: 反省を反映させた最終コードを commit し、PR の説明文に「今回得られた新しい知見」をナレッジとして記述してください。

---
**具体的タスク:**
`main.py` の Qdrant へのデータ投入ロジックを分析し、バッチ処理化とエラーリトライ処理を組み込んだ最適化を行い、PR を作成してください。
